---
pagetitle: 'Exercise: Demography'
output: 
  html_document:
    toc: FALSE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy(position = c('top', 'right'))
```

# Exercise: Demography {.tabset}

##  Question 1
**Yearly variation in the numbers of breeding Darwin’s finches (*Geospiza fortis* and *G. scandens*)**

The breeding success of Darwin’s finches on the Galapagos islands depends to a large extent on weather. During dry years the nesting success can be very low, causing large fluctuations in bird numbers from year to year.
The following table gives the number of breeding pairs in two finch species during 1976-1991.

```{r, eval=TRUE, echo=FALSE}
Year <- 1976:1991
G.fortis <- c(509, 0, 129, 123, 136, 171, 74, 405, 332, 0, 32, 214, 0, 0, 120, 241)
G.scandens <- c(160, 86, 103, 70, 129, 130, 103, 253, 217, 0, 20, 55, 8, 5, 13, 42)
Darwin.finches <- data.frame(Year, G.fortis, G.scandens)
knitr::kable(
  Darwin.finches, format = "html", table.attr = "style='width:60%;'", col.names = c('year', '*G. fortis* pairs', '*G. scandens* pairs')
)
```

\
Calculate the mean number of breeding pairs ($\bar x$), standard deviation ($s$), variance ($s^2$) and coefficient of variation ($C.V.$) for the two species. Which of the species is more sensitive to weather fluctuations?
If we denote the number of breeding pairs in a given year with $x_i$, then the required formulas are as follows.

$$
\begin{align}
\bar x & = \frac{\sum_{i=1}^{n}x_i}{n} \\
s^2 & = \frac{\sum_{i=1}^{n}(x_i-\bar x)^2}{n-1} \\
s & = \sqrt{s^2} \\
C.V. & = \frac{s}{\bar x}
\end{align}
$$

\
The coefficient of variation expresses variation within a variable relative to the magnitude of the variable. This is important because variance increases with the magnitude of the measured variable. The standardization allows us to *compare* variation across different variables (such as length of earthworms and length of anacondas), see [**here**](https://en.wikipedia.org/wiki/Coefficient_of_variation) for more information.

**Answer:**

```{r, eval=TRUE, echo=FALSE}
answers <- data.frame(species = c('*G. fortis*', '*G. scandens*'), mean = c(mean(Darwin.finches$G.fortis), mean(Darwin.finches$G.scandens)), s = c(sd(Darwin.finches$G.fortis), sd(Darwin.finches$G.scandens)), var = c(var(Darwin.finches$G.fortis), var(Darwin.finches$G.scandens)), CV = c(sd(Darwin.finches$G.fortis)/mean(Darwin.finches$G.fortis), sd(Darwin.finches$G.scandens)/mean(Darwin.finches$G.scandens)))

knitr::kable(
  answers, digits = 2, format = "html", table.attr = "style='width:70%;'", col.names = c('species', 'mean', '$s$', '$s^2$', '$C.V.$')
)
```

\
*Geospiza fortis* is more sensitive to weather fluctuations because it has a higher $C.V.$

Note, that it could actually be argued that the data reported here constitute the whole population, in which case the appropriate measure of variance is not the *sample variance* but the *population variance*, which we calculate according to
$$
\sigma^2 = \frac{\sum_{i=1}^{n}(x_i-\bar x)^2}{n}.
$$

## Question 2

**Fecundity of the chamois (*Rupicapra rupicapra*) in New Zealand**

The chamois gives birth during a short period in spring (birth pulse, discrete breeder). 275 females from all age groups were shot during this period to study female fecundity (these are hunting data). Females that were pregnant, had active milk glands, or bore signs of previous pregnancy were considered as reproductively active during that particular season. Litter size is supposed to be 1, and the sex ratio among the new born is 1/2 (equally many sons and daughters). The following table gives the number of reproductively active females in each age group.

```{r, eval=TRUE, echo=FALSE}
age <- 0:8
Number.shot <- c(0, 60, 36, 70, 48, 26, 19, 6, 10)
Number.reproductive <- c(0, 2, 14, 52, 45, 19, 16, 5, 7)
chamois <- data.frame(age, Number.shot, Number.reproductive)
knitr::kable(
  chamois, format = "html", table.attr = "style='width:80%;'", col.names = c('age in years ($x$)', 'no. shot ($f_x$)', 'no. reprod. active ($B_x$)')
)
```


1. Calculate fecundity, i.e., the number of daughters per female. This can be calculated as
$$
m_x = B_x /(2f_x),
$$
where $f_x$ is the number of shot females that were aged $x$ years old, and $B_x$ is the number of those that were considered reproductively active. The $2$ in the denominator stems from the fact that on average only half of the offspring are female.

2. Draw a graph showing fecundity as a function of age. Explain what you see. When is a chamois female fully fecund? Calculate average fecundity over all fully fecund age groups.

**Answer:**

```{r, eval=TRUE, echo=FALSE}
chamois$fecundity <- chamois$Number.reproductive/(2*chamois$Number.shot)
chamois$fecundity[1] <- 0

knitr::kable(
  chamois, digits = 3, format = "html", table.attr = "style='width:90%;'", col.names = c('age in years ($x$)', 'no. shot ($f_x$)', 'no. reprod. active ($B_x$)', 'age-specific fecundity ($m_x$)')
)

plot(chamois$age, chamois$fecundity, type = "o", xlab = 'age', ylab = 'fecundity')
```

To be able to answer this question, we have to clarify what is meant with "fully fecund". We can see that fecundity initially increases with age. One could argue that a chamois becomes fully fecund at age 3 and that fecundity from then onward somewhat fluctuates, which could simply be the result of the relative small size of the sample. If we accept this viewpoint, then the average fecundity of fully fecund females equals $0.399$ (the arithmetic mean over the last six age groups).

```{r, echo=FALSE, results='hide'}
round(mean(chamois$fecundity[4:9]), 3)
```


## Question 3

**Life table analysis in snails**

Here is a life table for a snail population:\

```{r, eval=TRUE, echo=FALSE}
age <- 0:3
a <- c(500, 400, 40, 0)
m <- c(0, 2.5, 3, 0)
snails <- data.frame(age, a, m)
knitr::kable(
  snails, format = "html", table.attr = "style='width:80%;'", col.names = c('age in years ($x$)', '$a_x$', '$m_x$')
  )
```

\
Complete the life table analysis by calculating $l(x)$, $R_0$, and $T_c$, and estimate $r$.

**Answer:**

```{r, eval=TRUE, echo=FALSE}
snails$l <- snails$a/snails$a[1]
snails <- snails[c("age", "a", "l", "m")]
snails$lm <- snails$l*snails$m
snails$xlm <- snails$age*snails$l*snails$m
knitr::kable(
  snails, format = "html", table.attr = "style='width:80%;'", col.names = c('age in years ($x$)', '$a_x$', '$l_x$', '$m_x$', '$l_x m_x$', '$x l_x m_x$')
  )
```

With this, we can calculate the net-reproductive ratio $R_0$ as

$$
R_0 = \sum_{x=0}^{x_{\rm max}}l_x m_x=2.24.
$$
Furthermore,
$$
\sum_{x=0}^{x_{\rm max}}x l_x m_x=2.48.
$$

Now we can calculate the cohort generation time $T_c$ as
$$
T_c = \frac{\sum_{x=0}^{x_{\rm max}}x l_x m_x}{R_0} = \frac{2.48}{2.24} = 1.107.
$$

Using the formula
$$
r \approx \frac{\ln R_0}{T_c}=\frac{\ln(2.24)}{1.107} = 0.729
$$

we obtain an approximate value for the intrinsic $r$.
We can conclude that this snail species shows a positive growth rate and is expected to increase in size rapidly.