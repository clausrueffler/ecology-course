<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercise: Demography II</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecology Course</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./PopulationDynamics.html">1. Excercise: Population Dynamics</a>
    </li>
    <li>
      <a href="./Demography.html">2. Excercise: Demography I</a>
    </li>
    <li>
      <a href="./Demography2.html">3. Excercise: Demography II</a>
    </li>
    <li>
      <a href="./StructuredPopulations.html">4. Excercise: Structured Populations</a>
    </li>
    <li>
      <a href="./Competition.html">5. Excercise: Competition</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<div id="life-tables-survivorship-curves-and-population-growth" class="section level1 tabset">
<h1 class="tabset">Life Tables, Survivorship Curves and Population Growth</h1>
<p>Note that this exercise consists of four <em>tabs</em>. Please work through the code in these tabs. Along the way, you are asked to answer five questions.</p>
<div id="theory" class="section level2">
<h2>Theory</h2>
<p>The material from this exercise is taken and modified from <em>Spreadsheet Exercises in Ecology and Evolution</em> by Therese M. Donovan and Charles W. Welden (Sinauer Associates 2002) and adapted for R. While doing this exercise, you will learn/refresh some R-coding related to vectors and data frames. But first a refresher of the theory.</p>
<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>A <strong>life table</strong> is a record of survival and reproductive rates in a population, broken out by age, size, or developmental stage (e.g., egg, hatchling, juvenile, adult). Ecologists and demographers (scientists who study human population dynamics) have found life tables useful in understanding patterns and causes of mortality, predicting the future growth or decline of populations, and managing populations of endangered species.</p>
<p>Predicting the growth and decline of human populations is one very important application of life tables. As you might expect, whether the population of a country or region increases or decreases depends in part on how many children each person has and the age at which people die. But it may surprise you to learn that population growth or decline also depends on the age at which they have their children. A major part of this exercise will explore the effects of changing patterns of survival and reproduction on population dynamics.</p>
<p>Life tables come in two varieties: cohort and static. A <strong>cohort life table</strong> follows the survival and reproduction of all members of a cohort from birth to death. A cohort is the set of all individuals born, hatched, or recruited into a population during a defined time interval. Cohorts are frequently defined on an annual basis (e.g., all individuals born in 1978), but other time intervals can be used as well.</p>
<p>A <strong>static life table</strong> records the number of living individuals of each age in a population and their reproductive output. The two varieties have distinct advantages and disadvantages, some of which we discuss below.</p>
<p>Life tables (whether cohort or static) that classify individuals by age are called <strong>age-based life tables</strong>. Such life tables treat age the same way we normally do: that is, individuals that have lived less than one full year are assigned age zero; those that have lived one year or more but less than two years are assigned age one; and so on. Life tables represent age by the letter <span class="math inline">\(x\)</span>, and use <span class="math inline">\(x\)</span> as a subscript to refer to survivorship, fecundity, and so on, for each age.</p>
<p><strong>Size-based</strong> and <strong>stage-based life tables</strong> classify individuals by size or developmental stage, rather than by age. Size-based and stage-based tables are often more useful or more practical for studying organisms that are difficult to classify by age, or whose ecological roles depend more on size or stage than on age. Such analyses are more complex, however, and we will consider them later.</p>
</div>
<div id="cohort-life-tables" class="section level3">
<h3>Cohort Life Tables</h3>
<p>To build a cohort life table for, let’s say, humans born in the United States during the year 1900, we would record how many individuals were born during the year 1900, and how many survived to the beginning of 1901, 1902, etc., until there were no more survivors. This record is called the <strong>survivorship schedule</strong>. Unfortunately, different textbooks use different notations for the number of survivors in each age; some write this as <span class="math inline">\(S_x\)</span>, some <span class="math inline">\(a_x\)</span>, and some <span class="math inline">\(n_x\)</span>. We will use <span class="math inline">\(a_x\)</span> here.</p>
<p>We must also record the <strong>fecundity schedule</strong> - the number of offspring born to individuals of each age. The total number of offpsring is usually divided by the number of individuals in the age, giving the <em>average</em> number of offspring per individual, or per capita fecundity. Again, different texts use different notations for the fecundity schedule, including <span class="math inline">\(b_x\)</span> or <span class="math inline">\(m_x\)</span> (we will use <span class="math inline">\(m_x\)</span>).</p>
<p>Many life tables count only females and their female offspring; for animals with two sexes and equal numbers of males and females of each age, the resulting numbers are the same as if males and females were both counted. For most plants, hermaphroditic animals, and many other organisms, distinctions between the sexes are nonexistent or more complex, and life table calculations may have to be adjusted.</p>
</div>
<div id="static-life-tables" class="section level3">
<h3>Static Life Tables</h3>
<p>A static life table is similar to a cohort life table but introduces a few complications. For many organisms, especially mobile animals with long life spans, it can be difficult or impossible to follow all the members of a cohort throughout their lives. In such cases, population biologists often count how many individuals of each age are alive at a given time. That is, they count how many members of the population are currently in the 0-1- year-old class, the 1-2-year-old class, etc., which obviously requires that we can measure the age of individuals (which is often difficult).</p>
<p>These counts can be used as if they were counts of survivors in a cohort, and all the calculations described below for a cohort life table can be performed using them. In doing this, however, the researcher must bear in mind that they assume that age-specific survivorship and fertility rates have remained constant since the oldest members of the population were born. This is usually not the case and can lead to some strange results, such as negative mortality rates. These are often resolved by averaging across several ages, or by making additional assumptions. We will avoid these complications by focusing this exercise on cohort life tables.</p>
</div>
<div id="quantities-in-a-life-table" class="section level3">
<h3>Quantities in a Life Table</h3>
<p>Survivorship and fecundity schedules are the raw data of any life table. From them we can calculate a variety of other quantities, including age-specific rates of survival, mortality, fecundity, survivorship curves, life expectancy, generation time, net reproductive rate, and intrinsic rate of increase. Which of these quantities you calculate will depend on your goals in constructing the life table. Rather than presenting all the quantities that may appear in a life table, we will present two applications of life tables, using the quantities needed in each case. First you will build life tables that illustrate the three classic survivorship curves. These curves are a powerful visual tool for understanding the patterns of survivorship and mortality in populations.Then you will use a life table to predict the future growth or decline of a population. This kind of analysis is frequently used in studies of human populations, in management of fish and game, and in attempts to rescue endangered species.</p>
</div>
<div id="survivorship-curves" class="section level3">
<h3>Survivorship Curves</h3>
<p>Ecology textbooks frequently present the three classic survivorship curves, called type I, type II, and type III (as shown on the lecture slides). To understand survivorship curves you can use survivorship schedules (<span class="math inline">\(a_x\)</span>) to calculate and graph standardized survivorship (<span class="math inline">\(l_x\)</span>), age-specific survivorship (<span class="math inline">\(g_x\)</span>), and life expectancy (<span class="math inline">\(e_x\)</span>).</p>
<p><strong>Standardized Survival Schedule (<span class="math inline">\(l_x\)</span>).</strong> Because we want to compare cohorts of different initial sizes, we standardize all cohorts to their initial size at time zero, <span class="math inline">\(a_0\)</span>. We do this by dividing each <span class="math inline">\(a_x\)</span> by <span class="math inline">\(a_0\)</span>. This proportion of original numbers surviving to the beginning of each interval is denoted <span class="math inline">\(l_x\)</span>, and calculated as <span class="math display">\[\begin{equation}
\tag{1}
l_x = \frac{a_x}{a_0}.
\end{equation}\]</span></p>
<p>We can also think of <span class="math inline">\(l_x\)</span> as the probability that an individual survives from birth to the beginning of age <span class="math inline">\(x\)</span>. Because we begin with all the individuals born during the year (or other interval), <span class="math inline">\(l_x\)</span> always begins at a value of one (i.e., <span class="math inline">\(a_0/a_0\)</span>), and can only decrease with time. At the last age, <span class="math inline">\(k\)</span>, <span class="math inline">\(a_k\)</span> is zero.</p>
<p><strong>Age-Specific Survivorship (<span class="math inline">\(g_x\)</span>).</strong> Standardized survivorship, <span class="math inline">\(l_x\)</span>, gives us the probability of an individual surviving from birth to the beginning of age <span class="math inline">\(x\)</span>. But what if we want to know the probability that an individual who has already survived to age <span class="math inline">\(x\)</span> will survive to age <span class="math inline">\(x + 1\)</span>? We calculate this age-specific survivorship as <span class="math inline">\(g_x = l_{x+1}/l_x\)</span>, or, equivalently, <span class="math display">\[\begin{equation}
\tag{2}
g_x = \frac{a_{x+1}}{a_x}.
\end{equation}\]</span></p>
<p><strong>Life Expectancy (<span class="math inline">\(e_x\)</span>).</strong> You may have heard another demographic statistic, life expectancy, mentioned in discussions of human populations. Life expectancy is how much longer an individual of a given age can be expected to live beyond its present age. Life expectancy is calculated in three steps. First, we compute the proportion of survivors at the mid-point of each time interval (<span class="math inline">\(L_x\)</span> - note the capital <span class="math inline">\(L\)</span> here) by averaging <span class="math inline">\(l_x\)</span> and <span class="math inline">\(l_{x+1}\)</span>; that is, <span class="math display">\[\begin{equation}
\tag{3}
L_x = \frac{l_x + l_{x+1}}{2}
\end{equation}\]</span></p>
<p>Second, we sum all the <span class="math inline">\(L\)</span>-values from the age of interest (<span class="math inline">\(x\)</span>) up to the oldest age, <span class="math inline">\(k\)</span> (note that in the below formula I use the index <span class="math inline">\(i\)</span> instead of <span class="math inline">\(x\)</span> because <span class="math inline">\(x\)</span> is not the age of interest): <span class="math display">\[\begin{equation}
\tag{4}
T_x = \sum_{i=x}^k L_i.
\end{equation}\]</span></p>
<p>Finally, we calculate life expectancy for an individual that has reached age <span class="math inline">\(x\)</span> as (note the lowercase <span class="math inline">\(l_x\)</span>) <span class="math display">\[\begin{equation}
\tag{5}
e_x = \frac{T_x}{l_x}.
\end{equation}\]</span></p>
<p>Life expectancy is age-specific – it is the expected number of time-intervals remaining to members of a given age. The statistic most often quoted (usually without qualification) is the life expectancy at birth (<span class="math inline">\(e_0\)</span>). As you will see, the implications of <span class="math inline">\(e_0\)</span> depend greatly on the survivorship schedule.</p>
</div>
<div id="population-growth-or-decline" class="section level3">
<h3>Population Growth or Decline</h3>
<p>We frequently want to know whether a population can be expected to grow, shrink, or remain stable, given its current age-specific : the number of offspring a newborn individual can expect to have during its life time. To predict long-term changes in population size, we must use this net reproductive rate to estimate the intrinsic rate of increase (<span class="math inline">\(r\)</span>).</p>
<p><strong>Net Reproductive Rate (<span class="math inline">\(R_0\)</span>).</strong> We calculate net reproductive rate (<span class="math inline">\(R_0\)</span>) by multiplying the standardized survivorship of each age (<span class="math inline">\(l_x\)</span>) by its fecundity (<span class="math inline">\(m_x\)</span>), and summing these products: <span class="math display">\[\begin{equation}
\tag{6}
R_0 = \sum_{x = 0}^k l_x m_x.
\end{equation}\]</span></p>
<p>The net reproductive rate is the lifetime reproductive potential of the average female, adjusted for survival. Assuming survival and fertility schedules remain constant over time, if <span class="math inline">\(R_0 &gt; 1\)</span>, then the population will grow exponentially. If <span class="math inline">\(R_0 &lt; 1\)</span>, the population will shrink exponentially, and if <span class="math inline">\(R_0 = 1\)</span>, the population size will not change over time. You may be tempted to conclude the <span class="math inline">\(R_0 = r\)</span>, the intrinsic rate of increase of the exponential model. However, this is not quite correct, because <span class="math inline">\(r\)</span> measures population change in absolute units of time (e.g., years) whereas <span class="math inline">\(R_0\)</span> measures population change in terms of generation time. To convert <span class="math inline">\(R_0\)</span> into <span class="math inline">\(r\)</span>, we must first calculate generation time (<span class="math inline">\(G\)</span>), and then adjust <span class="math inline">\(R_0\)</span>.</p>
<p><strong>Generation Time.</strong> Generation time, more specifically, the <em>cohort generation time</em> <span class="math inline">\(T_c\)</span> is defined as the average length of time between the birth of an individual and the birth of one of its own offspring, and is calculated as <span class="math display">\[\begin{equation}
\tag{7}
T_c = \frac{\sum_{x = 0}^k l_x m_x x}{\sum_{x = 0}^k l_x m_x}.
\end{equation}\]</span> Here, the numerators is the sum of the ages at which a member of the cohort obtains an offspring and the denominator is simply <span class="math inline">\(R_0\)</span>.</p>
<p>For organisms that live only one year, the numerator and denominator will be equal, and generation time will equal one year. For all longer-lived organisms, generation time will be greater than one year, but exactly how much greater will depend on the survival and fertility schedules. A long-lived species that reproduces at an early age may have a shorter generation time than a shorter-lived one that delays reproduction.</p>
<p><strong>Intrinsic Rate of Increase.</strong> We can use our knowledge of exponential population growth and our value of <span class="math inline">\(R_0\)</span> to estimate the intrinsic rate of increase (<span class="math inline">\(r\)</span>). Recall from the lecture that the size of an exponentially growing population at some arbitrary time <span class="math inline">\(t\)</span> is <span class="math inline">\(N(t) = N_0 \exp(rt)\)</span>. If we consider the growth of such a population from time zero through one generation time, G, it is <span class="math display">\[\begin{equation}
\tag{8}
N_G = N_0\exp(rT_c)
\end{equation}\]</span> Dividing both sides by <span class="math inline">\(N_0\)</span> gives us <span class="math display">\[\begin{equation}
\tag{9}
\frac{N_G}{N_0} = \exp(rT_c).
\end{equation}\]</span> We can think of <span class="math inline">\(N_G / N_0\)</span> as roughly equivalent to <span class="math inline">\(R_0\)</span>; both are estimates of the rate of population growth over the period of one generation.</p>
<p>Substituting <span class="math inline">\(R_0\)</span> into the equation gives us <span class="math inline">\(R_0 \approx \exp(rT_c)\)</span>. Taking the natural logarithm of both sides gives us <span class="math inline">\(\ln (R_0) \approx r T_c\)</span> and dividing through by <span class="math inline">\(T_c\)</span> gives us an estimate of <span class="math inline">\(r\)</span>: <span class="math display">\[\begin{equation}
\tag{10}
r \approx \frac{\ln(R_0)}{T_c}.
\end{equation}\]</span> Note, that <span class="math inline">\(r\)</span> is positive if and only if <span class="math inline">\(R_0\)</span> is larger than one: the population growth rate is positive if and only if each female can expect to give birth to more than one daughter during its life time.</p>
<p>Finally, we can use our estimate of <span class="math inline">\(r\)</span> to predict the size of the population in the future (using <span class="math inline">\(N(t) = N_0 \exp(rt)\)</span>). In this exercise, you will adjust survivorship and fecundity schedules and observe the effects on population growth or decline. This kind of analysis is done for human populations to predict the effects of changes in medical care and birth control programs. If we assume that all age groups are roughly equivalent in size, a similar analysis can be done for endangered species to determine what intervention may be most effective in promoting population growth. The same analysis can be applied to pest species to determine what intervention may be most effective in reducing population size.</p>
</div>
</div>
<div id="doing-it-in-r" class="section level2">
<h2>Doing it in <em>R</em></h2>
<p>Our purpose here is to show how survivorship curves are generated and what they mean. You will use survivorship schedules to calculate and graph <span class="math inline">\(l_x\)</span>, <span class="math inline">\(g_x\)</span>, and <span class="math inline">\(e_x\)</span>, resulting in survivorship curves of type I, II, or III.</p>
<p>We start by creating a data frame data frame with the survivorship schedule for three hypothetical species that reach an age of up to 11 years. A data frame is R’s equivalent to an EXCEL spreadsheet. It consists of columns and rows, where objects of the same type are stored in columns and where these columns have names.</p>
<p>Here are the data for the three species, each collected in a vector.</p>
<pre class="r"><code>axSpecies1 &lt;- c(1000, 990, 970, 940, 900, 850, 750, 500, 200, 40, 1, 0)
axSpecies2 &lt;- c(2048, 1024, 512, 256, 128, 64, 32, 16, 8, 4, 2, 0)
axSpecies3 &lt;- c(10000, 100, 30, 20, 18, 17, 16, 15, 14, 13, 12, 0)</code></pre>
<p>Next, let us collect these vectors in a data frame, called <em>Counts</em>, and let us add a first column to it, called <em>age</em>:</p>
<pre class="r"><code>Counts &lt;- data.frame(age=0:11, axSpecies1, axSpecies2, axSpecies3)</code></pre>
<p>This is how this data frame looks:</p>
<pre class="r"><code>Counts</code></pre>
<pre><code>##    age axSpecies1 axSpecies2 axSpecies3
## 1    0       1000       2048      10000
## 2    1        990       1024        100
## 3    2        970        512         30
## 4    3        940        256         20
## 5    4        900        128         18
## 6    5        850         64         17
## 7    6        750         32         16
## 8    7        500         16         15
## 9    8        200          8         14
## 10   9         40          4         13
## 11  10          1          2         12
## 12  11          0          0          0</code></pre>
<p>This data frame contains the original counts from a <em>cohort life table</em>. Next, let us calculate <span class="math inline">\(l_x\)</span>, the proportion of individuals present in the original cohort surviving to the start of each age class, by dividing each count by the first count. In R, this can simply be done by dividing the vector of counts, by the first entry in the respective vector, which produced a new vector.</p>
<pre class="r"><code>lxSpecies1 &lt;- axSpecies1/axSpecies1[1]
lxSpecies2 &lt;- axSpecies2/axSpecies2[1]
lxSpecies3 &lt;- axSpecies3/axSpecies3[1]</code></pre>
<p>Let us again collect these in a data frame, called <em>Relative.Counts</em>.</p>
<pre class="r"><code>Relative.Counts &lt;- data.frame(age=0:11, lxSpecies1, lxSpecies2, lxSpecies3)
Relative.Counts</code></pre>
<pre><code>##    age lxSpecies1   lxSpecies2 lxSpecies3
## 1    0      1.000 1.0000000000     1.0000
## 2    1      0.990 0.5000000000     0.0100
## 3    2      0.970 0.2500000000     0.0030
## 4    3      0.940 0.1250000000     0.0020
## 5    4      0.900 0.0625000000     0.0018
## 6    5      0.850 0.0312500000     0.0017
## 7    6      0.750 0.0156250000     0.0016
## 8    7      0.500 0.0078125000     0.0015
## 9    8      0.200 0.0039062500     0.0014
## 10   9      0.040 0.0019531250     0.0013
## 11  10      0.001 0.0009765625     0.0012
## 12  11      0.000 0.0000000000     0.0000</code></pre>
<p>Now we everything to plot the survivorship curves for our three hypothetical species. Note that I here use <em>base R</em> for plotting. One way to plot several curves in the same graph is by “putting them on top of each other”. This means that we first create a plot with the first curve, to which we can add a name for the figure (<em>Survivorship Curves</em>) and axes labels. Then, using the command <code>lines</code>, we can add the curves for species two and three. For each line, we can specify the the color (<code>col</code>) and the symbol (<code>pch</code>). Finally, we can add a legend to the figure.</p>
<pre class="r"><code>plot(Relative.Counts$age, Relative.Counts$lxSpecies1, type = &quot;b&quot;, pch = 0, col=&quot;red&quot;, xlab = &quot;age&quot;, ylab = &quot;standardized survivorship, lx&quot;, main=&quot;Survivorship Curves&quot;)
lines(Relative.Counts$age, Relative.Counts$lxSpecies2, type = &quot;b&quot;, pch = 1, col=&quot;blue&quot;)
lines(Relative.Counts$age, Relative.Counts$lxSpecies3, type = &quot;b&quot;, pch = 2, col=&quot;orange&quot;)

legend(&quot;topright&quot;, c(&quot;lx, type 1&quot;, &quot;lx, type 2&quot;, &quot;lx, type 3&quot;), col =c(&quot;red&quot;, &quot;blue&quot;, &quot;orange&quot;), pch = c(0, 1, 2)) # adds a plot legend</code></pre>
<p><img src="Demography2_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>It is now very easy to plot the survivorship curves with <span class="math inline">\(l_x\)</span>-values on a log-scale. This is indeed the standard way to plot survivorship curves. All that we have to do is to add the command (<code>log="y"</code>) to the plot command.</p>
<pre class="r"><code>plot(Relative.Counts$age, Relative.Counts$lxSpecies1, log=&quot;y&quot;, type = &quot;b&quot;, pch = 0, col=&quot;red&quot;, xlab = &quot;age&quot;, ylab = &quot;standardized survivorship, lx&quot;, main=&quot;Survivorship Curves (log-scale)&quot;)
lines(Relative.Counts$age, Relative.Counts$lxSpecies2, type = &quot;b&quot;, pch = 1, col=&quot;blue&quot;)
lines(Relative.Counts$age, Relative.Counts$lxSpecies3, type = &quot;b&quot;, pch = 2, col=&quot;orange&quot;)

legend(&quot;topright&quot;, c(&quot;lx, type 1&quot;, &quot;lx, type 2&quot;, &quot;lx, type 3&quot;), col =c(&quot;red&quot;, &quot;blue&quot;, &quot;orange&quot;), pch = c(0, 1, 2)) # adds a plot legend</code></pre>
<p><img src="Demography2_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Doing this will produce an error message. The reason is that in each column the last value for <span class="math inline">\(l_x\)</span> equals zero and that <span class="math inline">\(\ln(0)=-\infty\)</span>, which R does not know how to plot. It therefore omits the value for <span class="math inline">\(x=11\)</span> from the plot.</p>
<ul>
<li><p><strong>Question 1</strong> Why do we plot survivorship curves on a semi-log scale (y-axis on a log-scale)?</p></li>
<li><p><strong>Question 2</strong> What do the shapes of the survivorship curves tell us about patterns of survival and mortality? Compare each curve to the corresponding graph of age-specific survivorship (which you produce with the next piece of code).</p></li>
</ul>
<p>Next, we calculate <span class="math inline">\(g_x\)</span>, the age-specific survivorship, or, in other words, the probability to survive to age <span class="math inline">\(x+1\)</span> for an individual that has survived to age <span class="math inline">\(x\)</span> (see Eq. 2).</p>
<pre class="r"><code>gxSpecies1 &lt;- lxSpecies1[-1]/lxSpecies1[-length(lxSpecies1)]
gxSpecies2 &lt;- lxSpecies2[-1]/lxSpecies2[-length(lxSpecies2)]
gxSpecies3 &lt;- lxSpecies3[-1]/lxSpecies3[-length(lxSpecies3)]

Survivorship &lt;- data.frame(age=0:10, gxSpecies1, gxSpecies2, gxSpecies3)
Survivorship</code></pre>
<pre><code>##    age gxSpecies1 gxSpecies2 gxSpecies3
## 1    0  0.9900000        0.5  0.0100000
## 2    1  0.9797980        0.5  0.3000000
## 3    2  0.9690722        0.5  0.6666667
## 4    3  0.9574468        0.5  0.9000000
## 5    4  0.9444444        0.5  0.9444444
## 6    5  0.8823529        0.5  0.9411765
## 7    6  0.6666667        0.5  0.9375000
## 8    7  0.4000000        0.5  0.9333333
## 9    8  0.2000000        0.5  0.9285714
## 10   9  0.0250000        0.5  0.9230769
## 11  10  0.0000000        0.0  0.0000000</code></pre>
<p>Let us plot age-specific survival for each species.</p>
<pre class="r"><code>plot(Survivorship$age, Survivorship$gxSpecies1, type = &quot;b&quot;, pch = 0, col=&quot;red&quot;, xlab = &quot;age&quot;, ylab = &quot;age-specific survival, gx&quot;, main=&quot;Age-Specific Survival&quot;)
lines(Survivorship$age, Survivorship$gxSpecies2, type = &quot;b&quot;, pch = 1, col=&quot;blue&quot;)
lines(Survivorship$age, Survivorship$gxSpecies3, type = &quot;b&quot;, pch = 2, col=&quot;orange&quot;)

legend(&quot;bottom&quot;, c(&quot;lx, type 1&quot;, &quot;lx, type 2&quot;, &quot;lx, type 3&quot;), col =c(&quot;red&quot;, &quot;blue&quot;, &quot;orange&quot;), pch = c(0, 1, 2)) # adds a plot legend</code></pre>
<p><img src="Demography2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Next in line is to calculate <span class="math inline">\(e_x\)</span>, the age-specific life expectancy, or, in other words, the life expectancy for an individual that has reached age <span class="math inline">\(x\)</span> (see Eq. 5) Thus, we first have to calculate <span class="math inline">\(L_x\)</span>, the relative number of survivors at a the midpoint between two age classes (Eq. 3). We can do this in one step by adding the vector <code>lxSpecies1</code> with the last entry removed (<code>lxSpecies1[-length(lxSpecies1)</code>) to <code>lxSpecies1</code> but with with the first entry removed (<code>xSpecies1[-1]</code>), and then divide by 2 (and in the same manner for species 2 and 3). Convince yourself that this procedure indeed gives the desired result.</p>
<pre class="r"><code>averagelxSpecies1 &lt;- (lxSpecies1[-length(lxSpecies1)] + lxSpecies1[-1]) / 2
averagelxSpecies2 &lt;- (lxSpecies2[-length(lxSpecies2)] + lxSpecies2[-1]) / 2
averagelxSpecies3 &lt;- (lxSpecies3[-length(lxSpecies3)] + lxSpecies3[-1]) / 2

averagelx &lt;- data.frame(age=0:10, Lx1=averagelxSpecies1, Lx2=averagelxSpecies2, Lx3=averagelxSpecies3)
averagelx</code></pre>
<pre><code>##    age    Lx1          Lx2     Lx3
## 1    0 0.9950 0.7500000000 0.50500
## 2    1 0.9800 0.3750000000 0.00650
## 3    2 0.9550 0.1875000000 0.00250
## 4    3 0.9200 0.0937500000 0.00190
## 5    4 0.8750 0.0468750000 0.00175
## 6    5 0.8000 0.0234375000 0.00165
## 7    6 0.6250 0.0117187500 0.00155
## 8    7 0.3500 0.0058593750 0.00145
## 9    8 0.1200 0.0029296875 0.00135
## 10   9 0.0205 0.0014648438 0.00125
## 11  10 0.0005 0.0004882812 0.00060</code></pre>
<p>To calculate the <span class="math inline">\(e_x\)</span>, we use some R-magic, namely, we define a function in R, called <code>ex</code>, that performs the calculation of Eq. 5 and Eq. 6 in one step:</p>
<pre class="r"><code>ex &lt;- function(x, averagelx, lx) {
  sum(averagelx[x:11]) / lx[x]
}</code></pre>
<p>This function has three arguments: (i) the age class <span class="math inline">\(x\)</span>, (ii) the vector containing all values <span class="math inline">\(L_x\)</span>, and (iii) the vector containing all values <span class="math inline">\(l_x\)</span>. In this function, the expression <code>sum(averagelx[x:11])</code> calculates <span class="math inline">\(T_x\)</span> as given by Eq. 4, which is then divided by the correct value for <span class="math inline">\(l_x\)</span>. Since we want <span class="math inline">\(e_x\)</span> for all age classes <span class="math inline">\(x\)</span>, we put this function in a <em>for loop</em> (if you take the course <em>Population and Community Ecology</em> in the next study period you will learn in more detail about for-loops).</p>
<pre class="r"><code>e1 &lt;- c() # creates an empty vector for storing the values ex
for (i in 0:11) {
  e1[i] &lt;- ex(i, averagelxSpecies1, lxSpecies1)
}</code></pre>
<p>This code produces a vector with all values <span class="math inline">\(a_x\)</span> for species 1. In order to calculate the corresponding vector for species 2 and 3, you have to replace in this code <code>e1</code> with <code>e2</code> and <code>e3</code>, respectively, and change <code>Species1</code> to <code>Species2</code> and <code>Species3</code>, respectively.</p>
<p>Once you did these calculations (and stored the results for species 2 and 3 in vectors called <code>e2</code> and <code>e3</code>) you should obtain the following data frame:</p>
<pre class="r"><code>lifeexp &lt;- data.frame(age=0:10, e1, e2, e3)
lifeexp</code></pre>
<pre><code>##    age       e1       e2       e3
## 1    0 6.641000 1.499023 0.525500
## 2    1 5.703030 1.498047 2.050000
## 3    2 4.810309 1.496094 4.666667
## 4    3 3.947872 1.492188 5.750000
## 5    4 3.101111 1.484375 5.333333
## 6    5 2.254118 1.468750 4.617647
## 7    6 1.488000 1.437500 3.875000
## 8    7 0.982000 1.375000 3.100000
## 9    8 0.705000 1.250000 2.285714
## 10   9 0.525000 1.000000 1.423077
## 11  10 0.500000 0.500000 0.500000</code></pre>
<p>and a plot as this:</p>
<pre class="r"><code>plot(lifeexp$age, lifeexp$e1, type = &quot;b&quot;, pch = 0, col=&quot;red&quot;, xlab = &quot;age&quot;, ylab = &quot;life expectancy, ex&quot;, main=&quot;Life Expectancy&quot;)
lines(0:10, lifeexp$e2, type = &quot;b&quot;, pch = 1, col=&quot;blue&quot;)
lines(0:10, lifeexp$e3, type = &quot;b&quot;, pch = 2, col=&quot;orange&quot;)

legend(&quot;topright&quot;, c(&quot;ex, type 1&quot;, &quot;ex, type 2&quot;, &quot;ex, type 3&quot;), col =c(&quot;red&quot;, &quot;blue&quot;, &quot;orange&quot;), pch = c(0, 1, 2)) # adds a plot legend</code></pre>
<p><img src="Demography2_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<ul>
<li><strong>Question 3</strong> How can you explain the patterns shown in the graphs for life expectancy?</li>
</ul>
</div>
<div id="fecundity-and-population-growth" class="section level2">
<h2>Fecundity and Population Growth</h2>
<p>Suvival is just one part of a life table. The other is fecundity at age <span class="math inline">\(x\)</span>, <span class="math inline">\(m_x\)</span>. For the purpose of this exercise, let us assume that all three species have the same fecundity schedule as collected the following vector <code>m</code>:</p>
<pre class="r"><code>m &lt;- c(0,0,0,0,3,3,3,3,3,3,3,1)</code></pre>
<p>This will allow us to investigate the effect of the different survival curves on population growth.</p>
<p>Let us now collect the survival and fecundity in a single data frame. You here see the code for species 1. Adapt this code to obtain the corresponding life table for species 2 and 3.</p>
<pre class="r"><code>species1 &lt;- data.frame(age=0:11, ax=axSpecies1, lx=lxSpecies1, mx=m)
species1</code></pre>
<pre><code>##    age   ax    lx mx
## 1    0 1000 1.000  0
## 2    1  990 0.990  0
## 3    2  970 0.970  0
## 4    3  940 0.940  0
## 5    4  900 0.900  3
## 6    5  850 0.850  3
## 7    6  750 0.750  3
## 8    7  500 0.500  3
## 9    8  200 0.200  3
## 10   9   40 0.040  3
## 11  10    1 0.001  3
## 12  11    0 0.000  1</code></pre>
<p>Note that we added a fecundity schedule. Let us now calculate the expected life time number of offspring, <span class="math inline">\(R_0\)</span> (see Eq. 6). To do this, let us add a column with the product of <span class="math inline">\(l_x\)</span> and <span class="math inline">\(m_x\)</span>.</p>
<pre class="r"><code>species1$lxmx &lt;- species1$lx*species1$mx
species1</code></pre>
<pre><code>##    age   ax    lx mx  lxmx
## 1    0 1000 1.000  0 0.000
## 2    1  990 0.990  0 0.000
## 3    2  970 0.970  0 0.000
## 4    3  940 0.940  0 0.000
## 5    4  900 0.900  3 2.700
## 6    5  850 0.850  3 2.550
## 7    6  750 0.750  3 2.250
## 8    7  500 0.500  3 1.500
## 9    8  200 0.200  3 0.600
## 10   9   40 0.040  3 0.120
## 11  10    1 0.001  3 0.003
## 12  11    0 0.000  1 0.000</code></pre>
<p>In order to calculate <span class="math inline">\(R_0\)</span>, we simply have to sum all entries in this last column. Here the result for species 1.</p>
<pre class="r"><code>R0.1 &lt;- sum(species1$lxmx)
R0.1</code></pre>
<pre><code>## [1] 9.723</code></pre>
<p>Finally, to estimate the intrinsic growth rate we have to calculate the cohort generation time <span class="math inline">\(T_c\)</span>. Let us first add one more column to the data frame, namely one with the product <span class="math inline">\(x*l_x*m_x\)</span>.</p>
<pre class="r"><code>species1$xlxmx &lt;- species1$age*species1$lx*species1$mx
species1</code></pre>
<pre><code>##    age   ax    lx mx  lxmx xlxmx
## 1    0 1000 1.000  0 0.000  0.00
## 2    1  990 0.990  0 0.000  0.00
## 3    2  970 0.970  0 0.000  0.00
## 4    3  940 0.940  0 0.000  0.00
## 5    4  900 0.900  3 2.700 10.80
## 6    5  850 0.850  3 2.550 12.75
## 7    6  750 0.750  3 2.250 13.50
## 8    7  500 0.500  3 1.500 10.50
## 9    8  200 0.200  3 0.600  4.80
## 10   9   40 0.040  3 0.120  1.08
## 11  10    1 0.001  3 0.003  0.03
## 12  11    0 0.000  1 0.000  0.00</code></pre>
<p>Using Eq. 7, we obtain, for species 1,</p>
<pre class="r"><code>Tc1 &lt;- sum(species1$xlxmx) / sum(species1$lxmx)
Tc1</code></pre>
<pre><code>## [1] 5.498303</code></pre>
<p>and then, using Eq. 10, an estimate for the intrinsic growth rate,</p>
<pre class="r"><code>r1 &lt;- log(R0.1) / Tc1
r1</code></pre>
<pre><code>## [1] 0.413672</code></pre>
<p>Repeat the same procedure for species 2 and 3.</p>
<p>You should obtain the following results, for all three species collected in a single data frame:</p>
<pre class="r"><code>data.frame(species=c(1 ,2, 3), R0=c(R0.1, R0.2, R0.3), Tc=c(Tc1, Tc2, Tc3), r=c(r1, r2, r3), lamdda=exp(c(r1, r2, r3)))</code></pre>
<pre><code>##   species        R0       Tc          r    lamdda
## 1       1 9.7230000 5.498303  0.4136720 1.5123611
## 2       2 0.3720703 4.944882 -0.1999385 0.8187811
## 3       3 0.0315000 6.733333 -0.5135299 0.5983796</code></pre>
<pre class="r"><code>sum(species2$lxmx)</code></pre>
<pre><code>## [1] 0.3720703</code></pre>
<pre class="r"><code>sum(species2$xlxmx)</code></pre>
<pre><code>## [1] 1.839844</code></pre>
<pre class="r"><code>sum(species2$xlxmx)/sum(species2$lxmx)</code></pre>
<pre><code>## [1] 4.944882</code></pre>
<pre class="r"><code>sum(species3$lxmx)</code></pre>
<pre><code>## [1] 0.0315</code></pre>
<pre class="r"><code>sum(species3$xlxmx)</code></pre>
<pre><code>## [1] 0.2121</code></pre>
<pre class="r"><code>sum(species3$xlxmx)/sum(species3$lxmx)</code></pre>
<pre><code>## [1] 6.733333</code></pre>
<ul>
<li><strong>Question 4</strong> Given the three species, have the same fecundity schedule, describe the effect of the different survival schedules on the reported quantities. What conclusions can you draw about the future population dynamics?</li>
</ul>
</div>
<div id="three-real-world-examples" class="section level2">
<h2>Three Real World Examples</h2>
<p>In this part of the exercise, we will compare the survivorship curves for three species, a mammal, a bird, and a Crustacean. The data on which these curves are based are real data collected in the wild.</p>
<p>The first table shows the survivorship schedule for the <a href="https://en.wikipedia.org/wiki/Ovis_dalli_dalli">Dall Mountain Sheep</a> (<em>Ovis dalli dalli</em>). Data are taken from Deevey (1947, Life tables for natural populations of animals, <em>The Quarterly Review of Biology</em> 22:283-314).</p>
<pre><code>##    age   ax    lx
## 1    0 1000 1.000
## 2    1  801 0.801
## 3    2  789 0.789
## 4    3  776 0.776
## 5    4  764 0.764
## 6    5  734 0.734
## 7    6  688 0.688
## 8    7  640 0.640
## 9    8  571 0.571
## 10   9  439 0.439
## 11  10  252 0.252
## 12  11   96 0.096
## 13  12    6 0.006
## 14  13    3 0.003
## 15  14    0 0.000</code></pre>
<p>The second table shows the survivorship schedule for the <a href="https://en.wikipedia.org/wiki/Song_thrush">Song Thrush</a> (<em>Turdus philomelos</em>). Data are from Deevey (1947, Life tables for natural populations of animals, <em>The Quarterly Review of Biology</em> 22:283-314).</p>
<pre><code>##    age   ax    lx
## 1    0 1000 1.000
## 2    1  444 0.444
## 3    2  259 0.259
## 4    3  123 0.123
## 5    4   51 0.051
## 6    5   30 0.030
## 7    6   17 0.017
## 8    7    6 0.006
## 9    8    3 0.003
## 10   9    0 0.000</code></pre>
<p>The third table shows the survivorship schedule for the <a href="https://en.wikipedia.org/wiki/Balanus_glandula">barnacle <em>Balanus glandula</em></a>. Data are from Connell (1970, A predator-prey system in the marine intertidal region. I. <em>Balanus glandula</em>, <em>Ecological Monographs</em> 40:49-78).</p>
<pre><code>##    age        ax        lx
## 1    0 1000000.0 1.0000000
## 2    1      62.0 0.0000620
## 3    2      34.0 0.0000340
## 4    3      20.0 0.0000200
## 5    4      15.5 0.0000155
## 6    5      11.0 0.0000110
## 7    6       6.5 0.0000065
## 8    7       2.0 0.0000020
## 9    8       2.0 0.0000020
## 10   9       0.0 0.0000000</code></pre>
<ul>
<li><strong>Question 5</strong> Plot the survivorship curves for the three species on a log-scale. For this, you have to modify some code from the beginning of this exercise. You should obtain a figure that looks as below. Note that, since the <span class="math inline">\(l_x\)</span>-values for the barnacle are much lower than for the other species, you have to add the option <code>ylim=c(2.00e-06, 1)</code> to the plot command. This option sets explicitly the range of the y-axis. Without this command, the curve for the barnacles will be cut off.</li>
</ul>
<p><img src="Demography2_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<ul>
<li><strong>Question 6</strong> How would you classify the three survivorship curves? Does this make sense in the light of the biology of the three species?</li>
</ul>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
