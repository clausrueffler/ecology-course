<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Structured Populations - Solutions</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecology Course</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./PopulationDynamics.html">1. Excercise: Population Dynamics</a>
    </li>
    <li>
      <a href="./Demography.html">2. Excercise: Demography I</a>
    </li>
    <li>
      <a href="./Demography2.html">3. Excercise: Demography II</a>
    </li>
    <li>
      <a href="./StructuredPopulations.html">4. Excercise: Structured Populations</a>
    </li>
    <li>
      <a href="./Competition.html">5. Excercise: Competition</a>
    </li>
    <li>
      <a href="./PredatorPrey.html">6. Excercise: Predator-Prey Interactions</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="exercise-structured-populations---solutions"
class="section level1 tabset">
<h1 class="tabset">Exercise: Structured populations - Solutions</h1>
<div id="population-projection" class="section level2">
<h2>Population projection</h2>
<p>Using the example from the lecture, you will in this exercise apply
matrix multiplication to project population dynamics for some time steps
into the future. At the end of this part, you should complet the
following tasks.</p>
<ol style="list-style-type: decimal">
<li>Project the population ten years into the future and describe how
the population changes in both absolute and relative numbers.</li>
</ol>
<p><span style="color:red">Population size fluctuates until the fourth
time step and from then on shows a montonic increase. If we would
project the time series for more than ten time steps we could see that
the increase in total population size is exponential. The distribution
of individuals over the three stages also fluctuates slightly during the
first time steps but is almost constant from the fourth time step
onwards. This is in fact an important property of matrix models. Once
the population starts to grow (or decline) exponentially the population
also reaches a stable stage distribution: the proportion of individuals
in the different stages stays constant, here given by (0.968, 0.022,
0.01).</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Compute the growth factor <span
class="math inline">\(\lambda\)</span> for ten years and describe how it
changes over time.</li>
</ol>
<p><span style="color:red">The observation under (1) is reflected in the
behavior of the <span class="math inline">\(\lambda\)</span>: this
annual growth factor fluctuates slightly for the first four time steps
but then stabilizes around 1.07. In other words, from the fourth time
step onwards the population grows from one year to the next by a fixed
factor 1.07.</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Do the computations under (1) and (2) for three different initial
population vectors <span class="math inline">\(N_0\)</span>, namely:
<span class="math inline">\(N_0=(1000, 30, 15)\)</span>, <span
class="math inline">\(N_0=(10, 0, 0)\)</span> and <span
class="math inline">\(N_0=(0, 10, 0)\)</span>. How do the results differ
from each other when using different starting vectors?</li>
</ol>
<p><span style="color:red">Changing the initial population vector only
affects the dynamics during the first couple of time steps in which the
dynamics fluctuate. Once the fluctuations have disappeared all
populations grow with the same annual grwoth factor <span
class="math inline">\(\lambda\approx 1.07\)</span> and reach the same
stable stage distribution (0.968, 0.022, 0.01). For the choice <span
class="math inline">\(N_0=(10, 0, 0)\)</span> we can see that the
initial fluctuations are more extreme and that it takes at least until
the sixth time step before the fluctuations disappear.</span></p>
<p>The following code shows how to define a population projection matrix
in R. We here use the three-by-three matrix from the lecture.</p>
<pre class="r"><code>transition.matrix &lt;- matrix(c(0.1,0,100,0.02,0.2,0,0,0.2,0.6), nrow=3, ncol=3, byrow=T)
transition.matrix</code></pre>
<pre><code>##      [,1] [,2]  [,3]
## [1,] 0.10  0.0 100.0
## [2,] 0.02  0.2   0.0
## [3,] 0.00  0.2   0.6</code></pre>
<p>We enter the three-dimensional vector describing the initial
population composition <span class="math inline">\(N_0\)</span> as a
matrix consisting of one column and three rows (in other words, as a
column vector).</p>
<pre class="r"><code>N.0 &lt;- matrix(c(1000, 30, 15), nrow=3, ncol=1, byrow=T)
N.0</code></pre>
<pre><code>##      [,1]
## [1,] 1000
## [2,]   30
## [3,]   15</code></pre>
<p>In order to obtain the vector describing the population composition
one time step into the future, we multiply the population projection
matrix <code>transition.matrix</code> from the right with the current
population vector <code>N.0</code>. This type of multiplication is
executed in R using the symbol <code>%*%</code>.</p>
<pre class="r"><code>(N.1 &lt;- transition.matrix %*% N.0) # the parentheses around a command make that the vector N.1 is immediately shown, that is, without explicitly asking for it as was done in the two previous commands.</code></pre>
<pre><code>##      [,1]
## [1,] 1600
## [2,]   26
## [3,]   15</code></pre>
<p>Below the results for the first 10 time steps</p>
<pre class="r"><code>N.2 &lt;- transition.matrix %*% N.1
N.3 &lt;- transition.matrix %*% N.2
N.4 &lt;- transition.matrix %*% N.3
N.5 &lt;- transition.matrix %*% N.4
N.6 &lt;- transition.matrix %*% N.5
N.7 &lt;- transition.matrix %*% N.6
N.8 &lt;- transition.matrix %*% N.7
N.9 &lt;- transition.matrix %*% N.8
N.10 &lt;- transition.matrix %*% N.9</code></pre>
<p>Next, compute the total number of individuals at time
<code>t=0</code>, <code>t=1</code> until <code>t=10</code> using the
command <code>sum()</code>.</p>
<pre class="r"><code>Ntot.0 &lt;- sum(N.0)
Ntot.1 &lt;- sum(N.1)
Ntot.2 &lt;- sum(N.2)
Ntot.2 &lt;- sum(N.2) 
Ntot.3 &lt;- sum(N.3)
Ntot.4 &lt;- sum(N.4) 
Ntot.5 &lt;- sum(N.5)
Ntot.6 &lt;- sum(N.6) 
Ntot.7 &lt;- sum(N.7)
Ntot.8 &lt;- sum(N.8) 
Ntot.9 &lt;- sum(N.9)
Ntot.10 &lt;- sum(N.10)</code></pre>
<p>If you have computed <em>Ntot</em> for the first ten time steps, you
can add them to the plot by changing <code>c(0:2)</code> to
<code>c(0:10)</code> (the points on the x-axis) and
<code>y=c(Ntot.0, Ntot.1, Ntot.2)</code> to
<code>y=c(Ntot.0, Ntot.1, Ntot.2, Ntot.3, Ntot.4, Ntot.5, Ntot.6, Ntot.7, Ntot.8, Ntot.9, Ntot.10)</code>
(the values on the y-axis) in the above code.</p>
<pre class="r"><code>plot(x=c(0:10), y=c(Ntot.0, Ntot.1, Ntot.2, Ntot.3, Ntot.4, Ntot.5, Ntot.6, Ntot.7, Ntot.8, Ntot.9, Ntot.10), xlab=&quot;Time (years)&quot;, ylab=&quot;Ntot.t&quot;, las=1)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Next, let’s have a look at the population composition. How is the
total number of individuals distributed over the different life-history
states? For this, we can plot the population vectors in form of a bar
plot.</p>
<pre class="r"><code>par(xpd=T) # allow plotting on margin (for legend)
barplot(cbind(N.0, N.1, N.2, N.3, N.4, N.5, N.6, N.7, N.8, N.9, N.10), las=1, col=c(&quot;grey&quot;, &quot;green&quot;, &quot;red&quot;), names.arg=c(&quot;N.0&quot;, &quot;N.1&quot;, &quot;N.2&quot;, &quot;N.3&quot;, &quot;N.4&quot;, &quot;N.5&quot;, &quot;N.6&quot;, &quot;N.7&quot;, &quot;N.8&quot;, &quot;N.9&quot;, &quot;N.10&quot;), ylab=&quot;Number of individuals&quot;, xlab=&quot;Time (years)&quot;)

legend(&quot;topleft&quot;, x=0.1, y=2000, bty=&quot;n&quot;, legend=c(&quot;Seeds&quot;, &quot;Seedlings&quot;, &quot;Adults&quot;), fill=c(&quot;grey&quot;, &quot;green&quot;, &quot;red&quot;), horiz=T)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>It is also common (and informative) to plot the population vectors as
relative numbers to show what fraction of the total population belongs
to each life history state. For this we have to divide the number of
individuals in each state by the total population size at that time
step.</p>
<pre class="r"><code>barplot(cbind(N.0/sum(N.0), N.1/sum(N.1), N.2/sum(N.2), N.3/sum(N.3), N.4/sum(N.4), N.5/sum(N.5), N.6/sum(N.6), N.7/sum(N.7), N.8/sum(N.8), N.9/sum(N.9), N.10/sum(N.10))*100, col=c(&quot;grey&quot;, &quot;green&quot;, &quot;red&quot;), las=1, names=c(&quot;N.0&quot;, &quot;N.1&quot;, &quot;N.2&quot;, &quot;N.3&quot;, &quot;N.4&quot;, &quot;N.5&quot;, &quot;N.6&quot;, &quot;N.7&quot;, &quot;N.8&quot;, &quot;N.9&quot;, &quot;N.10&quot;), ylab=&quot;Number of individuals&quot;, xlab=&quot;Time (years)&quot;)
legend(x=0.1, y=120, bty=&quot;n&quot;, legend=c(&quot;Seeds&quot;, &quot;Seedlings&quot;, &quot;Adults&quot;), fill=c(&quot;grey&quot;, &quot;green&quot;, &quot;red&quot;), horiz=T)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>N.10/sum(N.10) # vector giving the distribution at the end of the time series</code></pre>
<pre><code>##             [,1]
## [1,] 0.968335286
## [2,] 0.022255192
## [3,] 0.009409522</code></pre>
<p>Finally, to calculate the growth factor <span
class="math inline">\(\lambda\)</span> we have to divide the total
population size of two consecutive time steps by each other. This
results in</p>
<pre class="r"><code>lambda.1 &lt;- Ntot.1/Ntot.0
lambda.2 &lt;- Ntot.2/Ntot.1
lambda.3 &lt;- Ntot.3/Ntot.2
lambda.4 &lt;- Ntot.4/Ntot.3
lambda.5 &lt;- Ntot.5/Ntot.4
lambda.6 &lt;- Ntot.6/Ntot.5
lambda.7 &lt;- Ntot.7/Ntot.6
lambda.8 &lt;- Ntot.8/Ntot.7
lambda.9 &lt;- Ntot.9/Ntot.8
lambda.10 &lt;- Ntot.10/Ntot.9</code></pre>
<p>With this we can make a plot that shows how <span
class="math inline">\(\lambda\)</span> changes over time from <span
class="math inline">\(t=0\)</span> to <span
class="math inline">\(t=10\)</span>.</p>
<pre class="r"><code>plot(x=c(1:10), y=c(lambda.1, lambda.2, lambda.3, lambda.4, lambda.5, lambda.6, lambda.7, lambda.8, lambda.9, lambda.10), type=&quot;l&quot;, xlab=&quot;Time (years)&quot;, ylab=&quot;lambda&quot;, las=1)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Here the calucations for an alternative initial population vector
<span class="math inline">\(N_0=(10, 0, 0)\)</span>.</p>
<pre class="r"><code>N.0 &lt;- matrix(c(10, 0, 0), nrow=3, ncol=1, byrow=T)
N.1 &lt;- transition.matrix %*% N.0
N.2 &lt;- transition.matrix %*% N.1
N.3 &lt;- transition.matrix %*% N.2
N.4 &lt;- transition.matrix %*% N.3
N.5 &lt;- transition.matrix %*% N.4
N.6 &lt;- transition.matrix %*% N.5
N.7 &lt;- transition.matrix %*% N.6
N.8 &lt;- transition.matrix %*% N.7
N.9 &lt;- transition.matrix %*% N.8
N.10 &lt;- transition.matrix %*% N.9

Ntot.0 &lt;- sum(N.0)
Ntot.1 &lt;- sum(N.1)
Ntot.2 &lt;- sum(N.2)
Ntot.2 &lt;- sum(N.2) 
Ntot.3 &lt;- sum(N.3)
Ntot.4 &lt;- sum(N.4) 
Ntot.5 &lt;- sum(N.5)
Ntot.6 &lt;- sum(N.6) 
Ntot.7 &lt;- sum(N.7)
Ntot.8 &lt;- sum(N.8) 
Ntot.9 &lt;- sum(N.9)
Ntot.10 &lt;- sum(N.10)

plot(x=c(0:10), y=c(Ntot.0, Ntot.1, Ntot.2, Ntot.3, Ntot.4, Ntot.5, Ntot.6, Ntot.7, Ntot.8, Ntot.9, Ntot.10), xlab=&quot;Time (years)&quot;, ylab=&quot;Ntot.t&quot;, las=1)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>barplot(cbind(N.0/sum(N.0), N.1/sum(N.1), N.2/sum(N.2), N.3/sum(N.3), N.4/sum(N.4), N.5/sum(N.5), N.6/sum(N.6), N.7/sum(N.7), N.8/sum(N.8), N.9/sum(N.9), N.10/sum(N.10))*100, col=c(&quot;grey&quot;, &quot;green&quot;, &quot;red&quot;), las=1, names=c(&quot;N.0&quot;, &quot;N.1&quot;, &quot;N.2&quot;, &quot;N.3&quot;, &quot;N.4&quot;, &quot;N.5&quot;, &quot;N.6&quot;, &quot;N.7&quot;, &quot;N.8&quot;, &quot;N.9&quot;, &quot;N.10&quot;), ylab=&quot;Number of individuals&quot;, xlab=&quot;Time (years)&quot;)
legend(x=0.1, y=120, bty=&quot;n&quot;, legend=c(&quot;Seeds&quot;, &quot;Seedlings&quot;, &quot;Adults&quot;), fill=c(&quot;grey&quot;, &quot;green&quot;, &quot;red&quot;), horiz=T)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code>N.10/sum(N.10) # vector giving the distribution at the end of the time series</code></pre>
<pre><code>##             [,1]
## [1,] 0.968646603
## [2,] 0.021860123
## [3,] 0.009493274</code></pre>
<pre class="r"><code>lambda.1 &lt;- Ntot.1/Ntot.0
lambda.2 &lt;- Ntot.2/Ntot.1
lambda.3 &lt;- Ntot.3/Ntot.2
lambda.4 &lt;- Ntot.4/Ntot.3
lambda.5 &lt;- Ntot.5/Ntot.4
lambda.6 &lt;- Ntot.6/Ntot.5
lambda.7 &lt;- Ntot.7/Ntot.6
lambda.8 &lt;- Ntot.8/Ntot.7
lambda.9 &lt;- Ntot.9/Ntot.8
lambda.10 &lt;- Ntot.10/Ntot.9

plot(x=c(1:10), y=c(lambda.1, lambda.2, lambda.3, lambda.4, lambda.5, lambda.6, lambda.7, lambda.8, lambda.9, lambda.10), type=&quot;l&quot;, xlab=&quot;Time (years)&quot;, ylab=&quot;lambda&quot;, las=1)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-11-3.png" width="672" /></p>
</div>
<div id="conservation-measures" class="section level2">
<h2>Conservation measures</h2>
<p>Consider a population of a rare meadow plant. In this exercise, we
explore how we can use matrix models to investigate the efficiency of
different conservation strategies. Assume that after an intensive period
of data collection we determined the following population transition
matrix.</p>
<pre class="r"><code>meadow.matrix &lt;- matrix(c(0.001,0,200,0.01,0.2,0,0,0.2,0), nrow=3, ncol=3, byrow=T)
meadow.matrix</code></pre>
<pre><code>##       [,1] [,2] [,3]
## [1,] 0.001  0.0  200
## [2,] 0.010  0.2    0
## [3,] 0.000  0.2    0</code></pre>
<p>and the initial population vector <code>N.0</code> given by</p>
<pre class="r"><code>N.0 &lt;- matrix(c(3000, 180, 30), nrow=3, ncol=1, byrow=T)
N.0</code></pre>
<pre><code>##      [,1]
## [1,] 3000
## [2,]  180
## [3,]   30</code></pre>
<p>At the end of this exercise you should answer the following
questions.</p>
<ol style="list-style-type: decimal">
<li>Draw the life cycle graph corresponding to this matrix. What kind of
life history does this plant have?</li>
</ol>
<div class="figure">
<img src="images/LifeCycle.png" alt="Life cycle graph" width="100%" />
<p class="caption">
Life cycle graph
</p>
</div>
<p><span style="color:red">This plant is an semelparous biennal plant
with seed bank.</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Calculate the projected population growth rate <span
class="math inline">\(\lambda\)</span> and the total population size
<code>N.tot</code> for 10 years and plot them as a function of time.
After how many years would this population be expected to have less than
10 adults where it would be considered severely endangered?</li>
</ol>
<p><span style="color:red">See graphs below. Note that for this matrix
and this initial population vector <span
class="math inline">\(\lambda\)</span> is still somewhat fluctuating
after ten time steps. However, after 10 time steps it becomes already
clear that the stable value of <span
class="math inline">\(\lambda\)</span> will be below 1 and that
therefore without conservation measurements this population will go
extinct. Thus, in order to find the final According to the below graphs
the adult population size drops below 10 after five time
steps.</span></p>
<ol start="3" style="list-style-type: decimal">
<li>To protect this population, two different measures are considered.
For each of these methods, project the population dynamics and plot the
number of adults against time. Which conservation measure is
preferable?</li>
</ol>
<ol style="list-style-type: lower-roman">
<li>Adding 100 adult plants from a different population once at year
<span class="math inline">\(t=0\)</span>.</li>
</ol>
<p><span style="color:red">This conservation measurement only has a
short term benefit but ultimately this population decreases as well. In
fact, we could have anticipated this result since we found out in the
first part of this exercise that the long term dynamics of a population
are independent of the initial population vector and only depend on the
entries of the transition matrix.</span></p>
<ol start="2" style="list-style-type: lower-roman">
<li>Increasing recruitment of juveniles from seeds by creating small
open sites in the meadow each year. This is expected to result in a
transition probability from seeds to juveniles equal to <span
class="math inline">\(0.025\)</span>.</li>
</ol>
<p><span style="color:red">This conservation mearsurement results in a
long term increase of the popuolation. Thus, this is clearly the
preferred conservation measurement.</span></p>
<p>In order to make investigating these questions easier, we need some
additional R-magic. In particular, we want to use R-code that let’s us
compute a whole time series with a single command. For this, we make use
of what is called a <em>for-loop</em>.</p>
<p>Before we “run” the for-loop to create a time series, we create a
so-called <em>data frame</em> in which we can store the data from the
time series of length <em>10</em>. We name this data frame
<code>pop.dev</code>, abbreviating <em>population development</em>, and
initially fill all entries with <code>NA</code>(for “not available”).
You can think of a data frame as an EXCEL sheet but in R. Thus, a data
frame is a matrix where we can give names to rows and columns to
describe what is stored in the different cells of the data frame.</p>
<pre class="r"><code>pop.dev &lt;- data.frame(time=c(0:10), Seeds=rep(NA,11), Juv=rep(NA,11), Adults=rep(NA,11), N=rep(NA,11), lambda=rep(NA,11))</code></pre>
<p>Let’s check how the data frame looks at the moment.</p>
<pre class="r"><code>pop.dev</code></pre>
<pre><code>##    time Seeds Juv Adults  N lambda
## 1     0    NA  NA     NA NA     NA
## 2     1    NA  NA     NA NA     NA
## 3     2    NA  NA     NA NA     NA
## 4     3    NA  NA     NA NA     NA
## 5     4    NA  NA     NA NA     NA
## 6     5    NA  NA     NA NA     NA
## 7     6    NA  NA     NA NA     NA
## 8     7    NA  NA     NA NA     NA
## 9     8    NA  NA     NA NA     NA
## 10    9    NA  NA     NA NA     NA
## 11   10    NA  NA     NA NA     NA</code></pre>
<p>Let us fill the first column of the data frame with the population
vector at time zero.</p>
<pre class="r"><code>pop.dev[1, &quot;Seeds&quot;] &lt;- N.0[1]
pop.dev[1, &quot;Juv&quot;] &lt;- N.0[2]
pop.dev[1, &quot;Adults&quot;] &lt;- N.0[3]
pop.dev[1, &quot;N&quot;] &lt;- sum(N.0)</code></pre>
<p>Check whether this was entered correctly by printing the data
frame.</p>
<pre class="r"><code>pop.dev</code></pre>
<p>Next, let us “wrap” a loop of length 10 around the matrix
multiplication.</p>
<pre class="r"><code>N.t &lt;-N.0 # this creates a new vector, called N.t, and we give it the values that are stored in N.0
for (n in 2:11) # the loop &quot;runs&quot; from n=2 to n=11 (representing the years 1 to 10 in the data frame)
{
  N.t.plus.1 &lt;- meadow.matrix %*% N.t # computes the population vector for the next time step
  pop.dev[n, &quot;N&quot;] &lt;- sum(N.t.plus.1) # the following lines enter the outcome into the data frame
  pop.dev[n, &quot;Seeds&quot;] &lt;- N.t.plus.1[1]
  pop.dev[n, &quot;Juv&quot;] &lt;- N.t.plus.1[2]
  pop.dev[n, &quot;Adults&quot;] &lt;- N.t.plus.1[3]
  pop.dev[n, &quot;lambda&quot;] &lt;- sum(N.t.plus.1)/sum(N.t)
  N.t &lt;- N.t.plus.1 # updates the current values stored in N.t
}</code></pre>
<p>If you wish, you can again inspect the data frame by printing it.</p>
<pre class="r"><code>pop.dev</code></pre>
<p>With the following command, we can plot the numbers for a specific
column in the data frame, for example, the total population size
<em>N</em>.</p>
<pre class="r"><code>plot(pop.dev$time, pop.dev$N, type=&quot;l&quot;, ylab=&quot;Total population size&quot;, xlab=&quot;Time (years)&quot;, las=1)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>In order to plot the entries of another column, we have to add the
name of that column to the second <code>pop.dev$</code> in the last line
of code. For example, if we want to plot the number of adults we have to
replace <code>pop.dev$N</code> with <code>pop.dev$Adults</code> (and
change the name of the label on the y-axis accordingly).</p>
<pre class="r"><code>plot(pop.dev$time, pop.dev$Adults, type=&quot;l&quot;, ylab=&quot;Number of Adults&quot;, xlab=&quot;Time (years)&quot;, las=1)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>And here is the code if you wish to plot the growth factor <span
class="math inline">\(\lambda\)</span> as a function of time.</p>
<pre class="r"><code>plot(pop.dev$time, pop.dev$lambda, type=&quot;l&quot;, ylab=&quot;Growth factor lambda&quot;, xlab=&quot;Time (years)&quot;, las=1)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Now you have to decide how you have to change the above code so that
it takes into account the above two conservation strategies.</p>
<p><span style="color:red">The following code produces the data for the
FIRST conservation measurement. Here, I only changed the vector
<code>N.0</code> by adding 100 adult individuals from <span
class="math inline">\(N_0=(3000, 180, 30)\)</span> to <span
class="math inline">\(N_0=(3000, 180, 130)\)</span>.</span></p>
<pre class="r"><code>N.0 &lt;- matrix(c(3000,180,130), nrow=3, ncol=1, byrow=T)

pop.dev.strategy.1 &lt;- data.frame(time=c(0:10), Seeds=rep(NA,11), Juv=rep(NA,11), Adults=rep(NA,11), N=rep(NA,11), lambda=rep(NA,11))

pop.dev.strategy.1[1, &quot;Seeds&quot;] &lt;- N.0[1]
pop.dev.strategy.1[1, &quot;Juv&quot;] &lt;- N.0[2]
pop.dev.strategy.1[1, &quot;Adults&quot;] &lt;- N.0[3]
pop.dev.strategy.1[1, &quot;N&quot;] &lt;- sum(N.0)

N.t &lt;-N.0 # the initial value of N.n is given by the value N.0
for (n in 2:11) # the year runs second to 11th row (i.e, year 1 to 10)
{
  N.t.plus.1 &lt;-  meadow.matrix %*% N.t
  pop.dev.strategy.1[n, &quot;N&quot;] &lt;- sum(N.t.plus.1)
  pop.dev.strategy.1[n, &quot;Seeds&quot;] &lt;- N.t.plus.1[1]
  pop.dev.strategy.1[n, &quot;Juv&quot;] &lt;- N.t.plus.1[2]
  pop.dev.strategy.1[n, &quot;Adults&quot;] &lt;- N.t.plus.1[3]
  pop.dev.strategy.1[n, &quot;lambda&quot;] &lt;- sum(N.t.plus.1)/sum(N.t)
  N.t &lt;- N.t.plus.1
}

plot(pop.dev.strategy.1$time, pop.dev.strategy.1$Adults, type=&quot;l&quot;, ylab=&quot;Number of Adults&quot;, xlab=&quot;Time (years)&quot;, las=1, col=&quot;green&quot;)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p><span style="color:red">The following code produces the data for the
SECOND conservation measurement. For this we have to change the first
entry in the second column from 0.01 to 0.025. This entry describes the
probability of seeds to develop into small plants.</span></p>
<pre class="r"><code>meadow.matrix &lt;- matrix(c(0.001,0,200,0.025,0.2,0,0,0.2,0), nrow=3, ncol=3, byrow=T)
N.0 &lt;- matrix(c(3000,180,30), nrow=3, ncol=1, byrow=T)

pop.dev.strategy.2 &lt;- data.frame(time=c(0:10), Seeds=rep(NA,11), Juv=rep(NA,11), Adults=rep(NA,11), N=rep(NA,11), lambda=rep(NA,11))

pop.dev.strategy.2[1, &quot;Seeds&quot;] &lt;- N.0[1]
pop.dev.strategy.2[1, &quot;Juv&quot;] &lt;- N.0[2]
pop.dev.strategy.2[1, &quot;Adults&quot;] &lt;- N.0[3]
pop.dev.strategy.2[1, &quot;N&quot;] &lt;- sum(N.0)

N.t &lt;-N.0 # the initial value of N.n is given by the value N.0
for (n in 2:11) # the year runs second to 11th row (i.e, year 1 to 10)
{
  N.t.plus.1 &lt;- meadow.matrix %*% N.t
  pop.dev.strategy.2[n, &quot;N&quot;] &lt;- sum(N.t.plus.1)
  pop.dev.strategy.2[n, &quot;Seeds&quot;] &lt;- N.t.plus.1[1]
  pop.dev.strategy.2[n, &quot;Juv&quot;] &lt;- N.t.plus.1[2]
  pop.dev.strategy.2[n, &quot;Adults&quot;] &lt;- N.t.plus.1[3]
  pop.dev.strategy.2[n, &quot;lambda&quot;] &lt;- sum(N.t.plus.1)/sum(N.t)
  N.t &lt;- N.t.plus.1
}

plot(pop.dev.strategy.2$time, pop.dev.strategy.2$Adults, type=&quot;l&quot;, ylab=&quot;Number of Adults&quot;, xlab=&quot;Time (years)&quot;, las=1, col=&quot;blue&quot;)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Once you have the time series for the three different scenarios
(population without conservation, population with measurement 1 and
population with measurement 2), you could use code like the following to
visualize the results in a single figure.</p>
<pre class="r"><code>plot(pop.dev$time, pop.dev$Adults, type=&quot;l&quot;, ylab=&quot;Number of Adults&quot;, xlab=&quot;Time (years)&quot;, las=1, col=&quot;red&quot;, ylim = c(0, 60))
lines(pop.dev$time, pop.dev.strategy.1$Adults, col=&quot;green&quot;)
lines(pop.dev$time, pop.dev.strategy.2$Adults, col=&quot;blue&quot;)
legend(&quot;top&quot;, legend=c(&quot;no measure&quot;, &quot;Meth. 1&quot;, &quot;Meth. 2&quot;), 
       col=c(&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;), lty=c(1,1,1), bty=&quot;n&quot;, horiz=TRUE, cex=0.9)</code></pre>
<p><img src="StructuredPopulationsSolutions_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<!-- (Code to produce the data for the SECOND conservation measurement. Here, I added ```+30```in the for loop where the population size at the next year is determined.) -->
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
